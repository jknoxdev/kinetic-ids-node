<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1901px" preserveAspectRatio="none" style="width:805px;height:1901px;background:#1A1A2E;" version="1.1" viewBox="0 0 805 1901" width="805px" zoomAndPan="magnify"><defs><filter height="300%" id="fd93ymx0ksjj6" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#7EC8E3" font-family="Arial" font-size="18" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="314" x="248.5" y="16.708">L.I.M.A. — Component Diagram</text><text fill="#888888" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="163" x="324" y="32.0918">Node + Gateway Internals</text><!--MD5=[b3f1db6b056eee3cb7bc4482000484a1]
cluster node_pkg--><polygon fill="#1A1A2E" filter="url(#fd93ymx0ksjj6)" points="102,58.9219,303,58.9219,310,95.1875,399,95.1875,399,784.9219,102,784.9219,102,58.9219" style="stroke: #FF6B35; stroke-width: 1.5;"/><line style="stroke: #FF6B35; stroke-width: 1.5;" x1="102" x2="310" y1="95.1875" y2="95.1875"/><text fill="#FF6B35" font-family="Arial" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="79" x="164" y="72.9888">LIMA Node</text><text fill="#FF6B35" font-family="Arial" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="195" x="106" y="88.1216">[nRF52840 / Zephyr RTOS]</text><!--MD5=[db2770510d4a287d5bcb38ecffe43dce]
cluster sensors--><polygon fill="#1A1A2E" filter="url(#fd93ymx0ksjj6)" points="138,115.9219,239,115.9219,246,137.0547,372,137.0547,372,213.9219,138,213.9219,138,115.9219" style="stroke: #FF6B35; stroke-width: 1.5;"/><line style="stroke: #FF6B35; stroke-width: 1.5;" x1="138" x2="246" y1="137.0547" y2="137.0547"/><text fill="#FF6B35" font-family="Arial" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="95" x="142" y="129.9888">Sensor Layer</text><!--MD5=[f97f06f0cfb6b7519c6d14147238f0c9]
cluster zephyr--><polygon fill="#1A1A2E" filter="url(#fd93ymx0ksjj6)" points="126,270.9219,278,270.9219,285,292.0547,375,292.0547,375,615.4219,126,615.4219,126,270.9219" style="stroke: #FF6B35; stroke-width: 1.5;"/><line style="stroke: #FF6B35; stroke-width: 1.5;" x1="126" x2="285" y1="292.0547" y2="292.0547"/><text fill="#FF6B35" font-family="Arial" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="146" x="130" y="284.9888">Zephyr Subsystems</text><!--MD5=[11ce9a4a35a443dfb2bbc796942c7cdc]
cluster connectivity--><polygon fill="#1A1A2E" filter="url(#fd93ymx0ksjj6)" points="226,662.9219,322,662.9219,329,684.0547,364,684.0547,364,760.9219,226,760.9219,226,662.9219" style="stroke: #FF6B35; stroke-width: 1.5;"/><line style="stroke: #FF6B35; stroke-width: 1.5;" x1="226" x2="329" y1="684.0547" y2="684.0547"/><text fill="#FF6B35" font-family="Arial" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="90" x="230" y="676.9888">Connectivity</text><!--MD5=[54143f2ae8ba8690653403b130ba7d94]
cluster gateway_pkg--><polygon fill="#1A1A2E" filter="url(#fd93ymx0ksjj6)" points="22,841.9219,174,841.9219,181,878.1875,424,878.1875,424,1889.9219,22,1889.9219,22,841.9219" style="stroke: #FF6B35; stroke-width: 1.5;"/><line style="stroke: #FF6B35; stroke-width: 1.5;" x1="22" x2="181" y1="878.1875" y2="878.1875"/><text fill="#FF6B35" font-family="Arial" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="104" x="47" y="855.9888">LIMA Gateway</text><text fill="#FF6B35" font-family="Arial" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="146" x="26" y="871.1216">[Raspberry Pi Zero]</text><!--MD5=[de27663135fb2e052162af2bb290886b]
cluster ingestion--><polygon fill="#1A1A2E" filter="url(#fd93ymx0ksjj6)" points="230,898.9219,304,898.9219,311,920.0547,400,920.0547,400,1129.9219,230,1129.9219,230,898.9219" style="stroke: #FF6B35; stroke-width: 1.5;"/><line style="stroke: #FF6B35; stroke-width: 1.5;" x1="230" x2="311" y1="920.0547" y2="920.0547"/><text fill="#FF6B35" font-family="Arial" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="68" x="234" y="912.9888">Ingestion</text><!--MD5=[2c917ed10241d073afda6bdfb626813e]
cluster broker_pkg--><polygon fill="#1A1A2E" filter="url(#fd93ymx0ksjj6)" points="248,1186.9219,303,1186.9219,310,1208.0547,378,1208.0547,378,1284.9219,248,1284.9219,248,1186.9219" style="stroke: #FF6B35; stroke-width: 1.5;"/><line style="stroke: #FF6B35; stroke-width: 1.5;" x1="248" x2="310" y1="1208.0547" y2="1208.0547"/><text fill="#FF6B35" font-family="Arial" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="49" x="252" y="1200.9888">Broker</text><!--MD5=[56cc7744dce0ba3f4b240a81bbd86b4d]
cluster processing--><polygon fill="#1A1A2E" filter="url(#fd93ymx0ksjj6)" points="247,1341.9219,380,1341.9219,387,1363.0547,392,1363.0547,392,1560.9219,247,1560.9219,247,1341.9219" style="stroke: #FF6B35; stroke-width: 1.5;"/><line style="stroke: #FF6B35; stroke-width: 1.5;" x1="247" x2="387" y1="1363.0547" y2="1363.0547"/><text fill="#FF6B35" font-family="Arial" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="127" x="251" y="1355.9888">Event Processing</text><!--MD5=[0334151241c2df87d13997940bbf650c]
cluster persistence--><polygon fill="#1A1A2E" filter="url(#fd93ymx0ksjj6)" points="122,1617.9219,214,1617.9219,221,1639.0547,387,1639.0547,387,1722.9219,122,1722.9219,122,1617.9219" style="stroke: #FF6B35; stroke-width: 1.5;"/><line style="stroke: #FF6B35; stroke-width: 1.5;" x1="122" x2="221" y1="1639.0547" y2="1639.0547"/><text fill="#FF6B35" font-family="Arial" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="86" x="126" y="1631.9888">Persistence</text><!--MD5=[5d862a6bf50ccb6523bf200b104f9290]
cluster egress--><polygon fill="#1A1A2E" filter="url(#fd93ymx0ksjj6)" points="46,1767.9219,102,1767.9219,109,1789.0547,374,1789.0547,374,1865.9219,46,1865.9219,46,1767.9219" style="stroke: #FF6B35; stroke-width: 1.5;"/><line style="stroke: #FF6B35; stroke-width: 1.5;" x1="46" x2="109" y1="1789.0547" y2="1789.0547"/><text fill="#FF6B35" font-family="Arial" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="50" x="50" y="1781.9888">Egress</text><!--MD5=[8d83a12329186457828b7f0308b4ff39]
entity imu--><rect fill="#0F3460" filter="url(#fd93ymx0ksjj6)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="79" x="153.5" y="149.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="148.5" y="154.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="148.5" y="187.8594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="59" x="163.5" y="171.0605">MPU6050</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="22" x="163.5" y="185.0293">IMU</text><!--MD5=[52a11c404d39c220b9052972b112ecc1]
entity baro--><rect fill="#0F3460" filter="url(#fd93ymx0ksjj6)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="88" x="268" y="149.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="263" y="154.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="263" y="187.8594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="50" x="278" y="171.0605">BMP280</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="68" x="278" y="185.0293">Barometric</text><!--MD5=[d3ee787af57c32a6985a7accf4146695]
entity motion--><rect fill="#1A3060" filter="url(#fd93ymx0ksjj6)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="102" x="142" y="304.9219"/><rect fill="#1A3060" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="137" y="309.9219"/><rect fill="#1A3060" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="137" y="342.8594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="42" x="152" y="326.0605">Motion</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="82" x="152" y="340.0293">Discriminator</text><!--MD5=[567192346149ae0109dea2b9891507c0]
entity pressure--><rect fill="#1A3060" filter="url(#fd93ymx0ksjj6)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="76" x="279" y="304.9219"/><rect fill="#1A3060" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="274" y="309.9219"/><rect fill="#1A3060" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="274" y="342.8594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="56" x="289" y="326.0605">Pressure</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="47" x="289" y="340.0293">Monitor</text><!--MD5=[f3bf232d90cabae66f0609ba50eb4d16]
entity aggregator--><rect fill="#1A3060" filter="url(#fd93ymx0ksjj6)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="91" x="238.5" y="425.9219"/><rect fill="#1A3060" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="233.5" y="430.9219"/><rect fill="#1A3060" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="233.5" y="463.8594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="35" x="248.5" y="447.0605">Event</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="71" x="248.5" y="461.0293">Aggregator</text><!--MD5=[6cc4354bc172bfab4bc5d504e938f9dd]
entity crypto--><rect fill="#2A1A4A" filter="url(#fd93ymx0ksjj6)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="110" x="240" y="551.4219"/><rect fill="#2A1A4A" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="235" y="556.4219"/><rect fill="#2A1A4A" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="235" y="589.3594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="90" x="250" y="572.5605">CryptoCell-310</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="40" x="250" y="586.5293">Signer</text><!--MD5=[356b21d33ae4bbe89a0e9541f25b232f]
entity ble--><rect fill="#0F3460" filter="url(#fd93ymx0ksjj6)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="105" x="242.5" y="696.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="237.5" y="701.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="237.5" y="734.8594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="85" x="252.5" y="718.0605">BLE 5.0 Stack</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="68" x="252.5" y="732.0293">Coded PHY</text><!--MD5=[fe42e5a4540f19786bf5acf05f7ccff0]
entity scanner--><rect fill="#0F3460" filter="url(#fd93ymx0ksjj6)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="98" x="246" y="932.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="241" y="937.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="241" y="970.8594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="78" x="256" y="954.0605">BLE Scanner</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="66" x="256" y="968.0293">blueZ / hci</text><!--MD5=[1fe25e6ad2a661c9f8478b5f50e2a15d]
entity publisher--><rect fill="#0F3460" filter="url(#fd93ymx0ksjj6)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="115" x="248.5" y="1065.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="243.5" y="1070.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="243.5" y="1103.8594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="95" x="258.5" y="1087.0605">MQTT Publisher</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="32" x="258.5" y="1101.0293">paho</text><!--MD5=[9707192b7e88357a9c38ee4eac329e3d]
entity mosquitto--><rect fill="#1A3060" filter="url(#fd93ymx0ksjj6)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="98" x="264" y="1220.9219"/><rect fill="#1A3060" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="259" y="1225.9219"/><rect fill="#1A3060" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="259" y="1258.8594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="62" x="274" y="1242.0605">Mosquitto</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="78" x="274" y="1256.0293">MQTT Broker</text><!--MD5=[7342edd9a184d8607391f4c130efbf01]
entity router--><rect fill="#1A3060" filter="url(#fd93ymx0ksjj6)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="101" x="263.5" y="1375.9219"/><rect fill="#1A3060" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="258.5" y="1380.9219"/><rect fill="#1A3060" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="258.5" y="1413.8594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="81" x="273.5" y="1397.0605">Event Router</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="66" x="273.5" y="1411.0293">subscriber</text><!--MD5=[58638f16dd491473315bd2a16a4aea64]
entity verifier--><rect fill="#2A1A4A" filter="url(#fd93ymx0ksjj6)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="81" x="263.5" y="1496.9219"/><rect fill="#2A1A4A" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="258.5" y="1501.9219"/><rect fill="#2A1A4A" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="258.5" y="1534.8594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="61" x="273.5" y="1518.0605">Signature</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="44" x="273.5" y="1532.0293">Verifier</text><!--MD5=[7a603111606425ec6ae263a7f93634a1]
entity sqlite--><path d="M138,1661.9219 C138,1651.9219 174,1651.9219 174,1651.9219 C174,1651.9219 210,1651.9219 210,1661.9219 L210,1696.5313 C210,1706.5313 174,1706.5313 174,1706.5313 C174,1706.5313 138,1706.5313 138,1696.5313 L138,1661.9219 " fill="#2C0E3F" filter="url(#fd93ymx0ksjj6)" style="stroke: #9B59B6; stroke-width: 1.5;"/><path d="M138,1661.9219 C138,1671.9219 174,1671.9219 174,1671.9219 C174,1671.9219 210,1671.9219 210,1661.9219 " fill="none" style="stroke: #9B59B6; stroke-width: 1.5;"/><text fill="#FFFFFF" font-family="Arial" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="37" x="148" y="1686.1323">SQLite</text><text fill="#FFFFFF" font-family="Arial" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="52" x="148" y="1698.937">Audit Log</text><!--MD5=[799e9543975076390d2a6ceafec8df6c]
entity queue--><rect fill="#1A3060" filter="url(#fd93ymx0ksjj6)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="125" x="245.5" y="1655.4219"/><rect fill="#1A3060" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="240.5" y="1660.4219"/><rect fill="#1A3060" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="240.5" y="1693.3594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="100" x="255.5" y="1676.5605">Queue Manager</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="105" x="255.5" y="1690.5293">flush-on-connect</text><!--MD5=[561e10e9526ace52200ca6d4072c2892]
entity push_h--><rect fill="#0F3460" filter="url(#fd93ymx0ksjj6)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="65" x="62.5" y="1801.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="57.5" y="1806.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="57.5" y="1839.8594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="31" x="72.5" y="1823.0605">Push</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="45" x="72.5" y="1837.0293">Notifier</text><!--MD5=[3f5443c6f56ec85c4b443f83cd998419]
entity siem_h--><rect fill="#0F3460" filter="url(#fd93ymx0ksjj6)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="83" x="162.5" y="1801.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="157.5" y="1806.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="157.5" y="1839.8594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="29" x="172.5" y="1823.0605">SIEM</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="63" x="172.5" y="1837.0293">Forwarder</text><!--MD5=[5ff9b73b4c4545a8b0a91e4c08418fca]
entity cloud_h--><rect fill="#0F3460" filter="url(#fd93ymx0ksjj6)" height="47.9375" style="stroke: #4A90D9; stroke-width: 2.0;" width="77" x="280.5" y="1801.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="275.5" y="1806.9219"/><rect fill="#0F3460" height="5" style="stroke: #4A90D9; stroke-width: 2.0;" width="10" x="275.5" y="1839.8594"/><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="35" x="290.5" y="1823.0605">Cloud</text><text fill="#FFFFFF" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="57" x="290.5" y="1837.0293">Uploader</text><path d="M415.5,546.9219 L415.5,571.4219 L350.12,575.4219 L415.5,579.4219 L415.5,603.4844 A0,0 0 0 0 415.5,603.4844 L558.5,603.4844 A0,0 0 0 0 558.5,603.4844 L558.5,556.9219 L548.5,546.9219 L415.5,546.9219 A0,0 0 0 0 415.5,546.9219 " fill="#0D2818" filter="url(#fd93ymx0ksjj6)" style="stroke: #27AE60; stroke-width: 1.0;"/><path d="M548.5,546.9219 L548.5,556.9219 L558.5,556.9219 L548.5,546.9219 " fill="#0D2818" style="stroke: #27AE60; stroke-width: 1.0;"/><text fill="#27AE60" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="74" x="421.5" y="561.2041">CryptoCell-310</text><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="105" x="421.5" y="572.8447">hardware accelerated</text><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="102" x="421.5" y="584.4854">ECDSA-P256 signing</text><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="122" x="421.5" y="596.126">per-event nonce&lt;/color&gt;</text><path d="M627,1650.9219 L627,1707.4844 L793,1707.4844 L793,1660.9219 L783,1650.9219 L627,1650.9219 " fill="#0D2818" filter="url(#fd93ymx0ksjj6)" style="stroke: #27AE60; stroke-width: 1.0;"/><path d="M783,1650.9219 L783,1660.9219 L793,1660.9219 L783,1650.9219 " fill="#0D2818" style="stroke: #27AE60; stroke-width: 1.0;"/><text fill="#27AE60" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="93" x="633" y="1665.2041">Always written first</text><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="120" x="633" y="1676.8447">Queue-and-flush pattern</text><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="120" x="633" y="1688.4854">Survives internet outage</text><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="145" x="633" y="1700.126">Local audit trail intact&lt;/color&gt;</text><path d="M440.5,1656.9219 L440.5,1701.8438 L591.5,1701.8438 L591.5,1666.9219 L581.5,1656.9219 L440.5,1656.9219 " fill="#0D2818" filter="url(#fd93ymx0ksjj6)" style="stroke: #27AE60; stroke-width: 1.0;"/><path d="M581.5,1656.9219 L581.5,1666.9219 L591.5,1666.9219 L581.5,1656.9219 " fill="#0D2818" style="stroke: #27AE60; stroke-width: 1.0;"/><text fill="#27AE60" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="81" x="446.5" y="1671.2041">Rejects unsigned</text><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="97" x="446.5" y="1682.8447">or tampered events</text><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="130" x="446.5" y="1694.4854">before any egress&lt;/color&gt;</text><!--MD5=[085122f4cbec0865ae5655052ffe2d8c]
link imu to motion--><path d="M193,198.1619 C193,225.2319 193,269.9719 193,299.1919 " fill="none" id="imu-&gt;motion" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="193,304.4619,197,295.4619,193,299.4619,189,295.4619,193,304.4619" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="70" x="194" y="240.2041">raw accel/gyro</text><text fill="#CCCCCC" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="67" x="195.5" y="251.8447">[I2C]&lt;/color&gt;</text><!--MD5=[d91d4d01b89be0b7ba00b4ee5e7fdbc9]
link baro to pressure--><path d="M312.76,198.1619 C313.64,225.2319 315.11,269.9719 316.06,299.1919 " fill="none" id="baro-&gt;pressure" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="316.23,304.4619,319.9453,295.3407,316.0729,299.4643,311.9493,295.592,316.23,304.4619" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="69" x="315" y="240.2041">pressure delta</text><text fill="#CCCCCC" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="67" x="316" y="251.8447">[I2C]&lt;/color&gt;</text><!--MD5=[cf549d50d0a94be914127ad89412d84d]
link motion to aggregator--><path d="M201.65,353.1519 C207.2,366.4019 215.2,382.9019 225,395.9219 C232.17,405.4519 241.25,414.6019 250.11,422.5319 " fill="none" id="motion-&gt;aggregator" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="253.9,425.8619,249.7968,416.9084,250.1504,422.5542,244.5046,422.9078,253.9,425.8619" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="65" x="226" y="393.2041">motion event</text><!--MD5=[2c4af2db6936246252a206ed84ccfabe]
link pressure to aggregator--><path d="M310.56,353.1519 C305.2,372.4819 297.55,400.0719 291.83,420.6719 " fill="none" id="pressure-&gt;aggregator" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="290.42,425.7519,296.6643,418.1355,291.7464,420.931,288.9509,416.0132,290.42,425.7519" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="73" x="303" y="393.2041">pressure event</text><!--MD5=[789b08637f7949d3ffafc8a5cf428a06]
link aggregator to crypto--><path d="M286.07,474.1519 C287.89,494.5919 290.55,524.4119 292.49,546.2119 " fill="none" id="aggregator-&gt;crypto" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="292.94,551.2919,296.128,541.9733,292.4976,546.3115,288.1594,542.6811,292.94,551.2919" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="71" x="291" y="514.2041">integrity event</text><!--MD5=[20788784c93910f366c1ff4812495cf6]
link crypto to ble--><path d="M295,599.4819 C295,624.4319 295,664.2719 295,691.2319 " fill="none" id="crypto-&gt;ble" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="295,696.4419,299,687.4419,295,691.4419,291,687.4419,295,696.4419" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#7EC8E3" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="72" x="296" y="644.2041">signed payload</text><!--MD5=[2774a6c7155f3b384eeab115e62cb228]
link scanner to publisher--><path d="M296.94,981.0419 C298.8,1003.1619 301.61,1036.6019 303.6,1060.3719 " fill="none" id="scanner-&gt;publisher" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="304.04,1065.5919,307.2545,1056.2824,303.6118,1060.6102,299.2839,1056.9675,304.04,1065.5919" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="94" x="306.5" y="1021.2041">BLE advertisement</text><text fill="#CCCCCC" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="101" x="303" y="1032.8447">raw payload&lt;/color&gt;</text><!--MD5=[37de4985ded6a92147fb957185689dac]
link publisher to mosquitto--><path d="M307.06,1114.1619 C308.3,1141.2319 310.35,1185.9719 311.69,1215.1919 " fill="none" id="publisher-&gt;mosquitto" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="311.93,1220.4619,315.5148,1211.2886,311.7017,1215.4671,307.5232,1211.6539,311.93,1220.4619" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="63" x="327.5" y="1156.2041">MQTT publish</text><text fill="#CCCCCC" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="98" x="310" y="1167.8447">lima/events&lt;/color&gt;</text><!--MD5=[a338100ca3b7e5f47f33e1e8ebbbe850]
link mosquitto to router--><path d="M313.15,1269.1619 C313.33,1296.2319 313.62,1340.9719 313.81,1370.1919 " fill="none" id="mosquitto-&gt;router" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="313.85,1375.4619,317.7727,1366.4279,313.8071,1370.4621,309.773,1366.4965,313.85,1375.4619" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="45" x="328" y="1311.2041">subscribe</text><text fill="#CCCCCC" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="73" x="314" y="1322.8447">lima/#&lt;/color&gt;</text><!--MD5=[9614cddcb3196a564517516f23d263db]
link router to verifier--><path d="M312.05,1424.1519 C310.42,1443.4819 308.11,1471.0719 306.37,1491.6719 " fill="none" id="router-&gt;verifier" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="305.95,1496.7519,310.7061,1488.1275,306.3782,1491.7702,302.7355,1487.4424,305.95,1496.7519" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="76" x="310" y="1464.2041">verify signature</text><!--MD5=[66436759b3d8cd1674802c4e73e1eede]
link verifier to sqlite--><path d="M263.49,1538.6419 C245.66,1547.7219 225.71,1560.4819 212,1576.9219 C195.27,1596.9919 185.5,1625.1519 180.08,1646.7219 " fill="none" id="verifier-&gt;sqlite" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="178.85,1651.7719,184.8703,1643.9772,180.0358,1646.9145,177.0985,1642.08,178.85,1651.7719" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#9B59B6" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="55" x="227" y="1587.2041">write event</text><text fill="#CCCCCC" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="83" x="213" y="1598.8447">[always]&lt;/color&gt;</text><!--MD5=[a445bce60eb940e54124054b471b4943]
link verifier to queue--><path d="M304.59,1545.0119 C305.31,1572.9819 306.51,1620.0819 307.28,1650.1919 " fill="none" id="verifier-&gt;queue" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="307.41,1655.2319,311.1773,1646.132,307.2815,1650.2335,303.18,1646.3377,307.41,1655.2319" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#AAAAAA" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="82" x="307" y="1593.2041">queue for egress</text><!--MD5=[b0fa40fcdb02e975154c0607e3090eed]
link queue to push_h--><path d="M278.59,1703.5919 C263.93,1713.8319 245.43,1724.8919 227,1730.9219 C204.34,1738.3319 138.52,1723.9019 120,1738.9219 C103.11,1752.6119 97.21,1777.0119 95.34,1796.3319 " fill="none" id="queue-&gt;push_h" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="94.91,1801.6319,99.6169,1792.9806,95.3099,1796.6479,91.6426,1792.3408,94.91,1801.6319" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#7EC8E3" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="83" x="121" y="1749.2041">flush when online</text><!--MD5=[52ae2aa8256b525e165df594e5488d0e]
link queue to siem_h--><path d="M269.94,1703.4719 C247.35,1717.4819 222.45,1733.6619 219,1738.9219 C207.92,1755.8019 204.31,1778.4019 203.39,1796.2019 " fill="none" id="queue-&gt;siem_h" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="203.19,1801.5519,207.5213,1792.7065,203.3756,1796.5553,199.5268,1792.4096,203.19,1801.5519" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#7EC8E3" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="83" x="220" y="1749.2041">flush when online</text><!--MD5=[342f6a06382da582f0f7b60eacf4ef1f]
link queue to cloud_h--><path d="M309.77,1703.6419 C311.69,1728.9219 314.77,1769.3619 316.84,1796.5219 " fill="none" id="queue-&gt;cloud_h" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="317.24,1801.7619,320.5339,1792.4802,316.8543,1796.7768,312.5577,1793.0972,317.24,1801.7619" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#7EC8E3" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="83" x="314" y="1749.2041">flush when online</text><!--MD5=[7724e88a9d9d9258ba0270b3c77ac682]
link ble to scanner--><path d="M295,745.2119 C295,788.4019 295,880.7519 295,927.5219 " fill="none" id="ble-&gt;scanner" style="stroke: #7EC8E3; stroke-width: 1.0;"/><polygon fill="#7EC8E3" points="295,932.7219,299,923.7219,295,927.7219,291,923.7219,295,932.7219" style="stroke: #7EC8E3; stroke-width: 1.0;"/><text fill="#FF6B35" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="98" x="320.5" y="811.2041">BLE 5.0 Coded PHY</text><text fill="#CCCCCC" font-family="Arial" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="147" x="296" y="822.8447">[Encrypted + Signed]&lt;/color&gt;</text><!--MD5=[2ed7db3ed98489b13e9ef58b5e0ae962]
link sqlite to GMN50--><path d="M187.12,1651.4819 C198.97,1629.9419 218.68,1601.7919 245.5,1589.4219 C280.41,1573.3219 555.07,1577.1519 591.5,1589.4219 C627.25,1601.4619 660.76,1629.0419 682.96,1650.5219 " fill="none" id="sqlite-GMN50" style="stroke: #7EC8E3; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><!--MD5=[0df9c1dfb3b58d5b89b7c765e2da8ceb]
link verifier to GMN53--><path d="M344.79,1543.6519 C361.69,1553.2019 381.23,1564.9519 398,1576.9219 C433.19,1602.0419 470.49,1635.4119 493.51,1656.9019 " fill="none" id="verifier-GMN53" style="stroke: #7EC8E3; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><!--MD5=[b9e0265d56b34b0ac291ae88bc2258d5]
@startuml component
!pragma layout smetana

skinparam {
    BackgroundColor #1a1a2e
    ArrowColor #7EC8E3
    ArrowFontColor #CCCCCC
    ArrowFontSize 10
    DefaultFontName Arial
    DefaultFontColor #E0E0E0
    DefaultFontSize 11
    ComponentBorderColor #4A90D9
    ComponentBorderThickness 2
    ComponentBackgroundColor #0f3460
    ComponentFontColor #FFFFFF
    ComponentFontSize 12
    PackageBorderColor #FF6B35
    PackageBorderThickness 2
    PackageBackgroundColor #1a1a2e
    PackageFontColor #FF6B35
    PackageFontSize 13
    DatabaseBorderColor #9B59B6
    DatabaseBackgroundColor #2C0E3F
    DatabaseFontColor #FFFFFF
    InterfaceBorderColor #7EC8E3
    InterfaceBackgroundColor #0f3460
    NoteBorderColor #27AE60
    NoteBackgroundColor #0D2818
    NoteFontColor #AAAAAA
    NoteFontSize 10
}

title <size:18><color:#7EC8E3><b>L.I.M.A. — Component Diagram</b></color></size>\n<size:12><color:#888888>Node + Gateway Internals</color></size>

package "LIMA Node\n[nRF52840 / Zephyr RTOS]" as node_pkg {

    package "Sensor Layer" as sensors {
        [MPU6050\nIMU] as imu #0f3460
        [BMP280\nBarometric] as baro #0f3460
    }

    package "Zephyr Subsystems" as zephyr {
        [Motion\nDiscriminator] as motion #1a3060
        [Pressure\nMonitor] as pressure #1a3060
        [Event\nAggregator] as aggregator #1a3060
        [CryptoCell-310\nSigner] as crypto #2a1a4a
    }

    package "Connectivity" as connectivity {
        [BLE 5.0 Stack\nCoded PHY] as ble #0f3460
    }

    imu - -> motion : <color:#AAAAAA>raw accel/gyro\n[I2C]</color>
    baro - -> pressure : <color:#AAAAAA>pressure delta\n[I2C]</color>
    motion - -> aggregator : <color:#AAAAAA>motion event</color>
    pressure - -> aggregator : <color:#AAAAAA>pressure event</color>
    aggregator - -> crypto : <color:#AAAAAA>integrity event</color>
    crypto - -> ble : <color:#7EC8E3>signed payload</color>
}

package "LIMA Gateway\n[Raspberry Pi Zero]" as gateway_pkg {

    package "Ingestion" as ingestion {
        [BLE Scanner\nblueZ / hci] as scanner #0f3460
        [MQTT Publisher\npaho] as publisher #0f3460
    }

    package "Broker" as broker_pkg {
        [Mosquitto\nMQTT Broker] as mosquitto #1a3060
    }

    package "Event Processing" as processing {
        [Event Router\nsubscriber] as router #1a3060
        [Signature\nVerifier] as verifier #2a1a4a
    }

    package "Persistence" as persistence {
        database "SQLite\nAudit Log" as sqlite #2C0E3F
        [Queue Manager\nflush-on-connect] as queue #1a3060
    }

    package "Egress" as egress {
        [Push\nNotifier] as push_h #0f3460
        [SIEM\nForwarder] as siem_h #0f3460
        [Cloud\nUploader] as cloud_h #0f3460
    }

    scanner - -> publisher : <color:#AAAAAA>BLE advertisement\nraw payload</color>
    publisher - -> mosquitto : <color:#AAAAAA>MQTT publish\nlima/events</color>
    mosquitto - -> router : <color:#AAAAAA>subscribe\nlima/#</color>
    router - -> verifier : <color:#AAAAAA>verify signature</color>
    verifier - -> sqlite : <color:#9B59B6>write event\n[always]</color>
    verifier - -> queue : <color:#AAAAAA>queue for egress</color>
    queue - -> push_h : <color:#7EC8E3>flush when online</color>
    queue - -> siem_h : <color:#7EC8E3>flush when online</color>
    queue - -> cloud_h : <color:#7EC8E3>flush when online</color>
}

ble - -> scanner : <color:#FF6B35>BLE 5.0 Coded PHY\n[Encrypted + Signed]</color>

note right of crypto
  <color:#27AE60>CryptoCell-310
  hardware accelerated
  ECDSA-P256 signing
  per-event nonce</color>
end note

note right of sqlite
  <color:#27AE60>Always written first
  Queue-and-flush pattern
  Survives internet outage
  Local audit trail intact</color>
end note

note bottom of verifier
  <color:#27AE60>Rejects unsigned
  or tampered events
  before any egress</color>
end note

@enduml

PlantUML version 1.2020.02(Sun Mar 01 10:22:07 UTC 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 17.0.18+8
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>